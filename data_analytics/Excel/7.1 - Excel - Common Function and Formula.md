2025-10-06 22:53

Status:

Tags: [[Excel]] [[Data Analysis]] 


# Excel Functions Study Guide for Data Analytics

## Table of Contents

1. [Basic Statistical Functions](https://claude.ai/chat/bdd0fc9c-fb6f-41ed-9a1a-5f5cdf8aa83b#basic-statistical-functions)
2. [Logical Functions](https://claude.ai/chat/bdd0fc9c-fb6f-41ed-9a1a-5f5cdf8aa83b#logical-functions)
3. [Lookup & Reference Functions](https://claude.ai/chat/bdd0fc9c-fb6f-41ed-9a1a-5f5cdf8aa83b#lookup--reference-functions)
4. [Conditional Aggregate Functions](https://claude.ai/chat/bdd0fc9c-fb6f-41ed-9a1a-5f5cdf8aa83b#conditional-aggregate-functions)
5. [Text Functions](https://claude.ai/chat/bdd0fc9c-fb6f-41ed-9a1a-5f5cdf8aa83b#text-functions)
6. [Date Functions](https://claude.ai/chat/bdd0fc9c-fb6f-41ed-9a1a-5f5cdf8aa83b#date-functions)
7. [Error Handling](https://claude.ai/chat/bdd0fc9c-fb6f-41ed-9a1a-5f5cdf8aa83b#error-handling)
8. [Advanced Functions](https://claude.ai/chat/bdd0fc9c-fb6f-41ed-9a1a-5f5cdf8aa83b#advanced-functions)
9. [Operators & Symbols](https://claude.ai/chat/bdd0fc9c-fb6f-41ed-9a1a-5f5cdf8aa83b#operators--symbols)
10. [Nested Function Patterns](https://claude.ai/chat/bdd0fc9c-fb6f-41ed-9a1a-5f5cdf8aa83b#nested-function-patterns)

---

## Basic Statistical Functions

### SUM

**Purpose:** Adds all values in a range  
**Syntax:** `=SUM(range)`  
**Example:** `=SUM(Salary)` - Total of all salaries

### AVERAGE

**Purpose:** Calculates the arithmetic mean  
**Syntax:** `=AVERAGE(range)`  
**Example:** `=AVERAGE(HourlyRate)` - Mean hourly rate

### COUNT

**Purpose:** Counts cells containing numeric values  
**Syntax:** `=COUNT(range)`  
**Example:** `=COUNT(TotalWorkingYears)` - Number of numeric entries

### COUNTA

**Purpose:** Counts all non-empty cells  
**Syntax:** `=COUNTA(range)`  
**Example:** `=COUNTA(Gender)` - Count of filled cells

### MIN

**Purpose:** Returns the smallest value  
**Syntax:** `=MIN(range)`  
**Example:** `=MIN(TotalWorkingYears)` - Minimum years worked

### MAX

**Purpose:** Returns the largest value  
**Syntax:** `=MAX(range)`  
**Example:** `=MAX(PercentSalaryHike)` - Highest salary increase

---

## Logical Functions

### IF

**Purpose:** Returns one value if condition is TRUE, another if FALSE  
**Syntax:** `=IF(condition, value_if_true, value_if_false)`  
**Example:** `=IF(JobSatisfaction="High", "Good", "Bad")`

### AND

**Purpose:** Returns TRUE only if all conditions are TRUE  
**Syntax:** `=AND(condition1, condition2, ...)`  
**Example:** `=AND(TotalWorkingYears>10, OverTime="Yes")`

### OR

**Purpose:** Returns TRUE if any condition is TRUE  
**Syntax:** `=OR(condition1, condition2, ...)`  
**Example:** `=OR(PerformanceRating="Excellent", PerformanceRating="Outstanding")`

### NOT

**Purpose:** Reverses the logical value  
**Syntax:** `=NOT(condition)`  
**Example:** `=NOT(OverTime="Yes")` - TRUE if no overtime

### XOR

**Purpose:** Returns TRUE if odd number of conditions are TRUE  
**Syntax:** `=XOR(condition1, condition2, ...)`  
**Example:** `=XOR(OverTime="Yes", BusinessTravel="Travel_Frequently")`

### IFS

**Purpose:** Tests multiple conditions without nesting  
**Syntax:** `=IFS(condition1, value1, condition2, value2, ...)`  
**Example:** `=IFS(PercentSalaryHike>20, "High", PercentSalaryHike>10, "Medium", TRUE, "Low")`

### SWITCH

**Purpose:** Evaluates expression against list of values  
**Syntax:** `=SWITCH(expression, value1, result1, value2, result2, ...)`  
**Example:** `=SWITCH(JobSatisfaction, "High", "Good", "Very High", "Great", "Other")`

---

## Lookup & Reference Functions

### VLOOKUP

**Purpose:** Searches vertically in first column, returns value from specified column  
**Syntax:** `=VLOOKUP(lookup_value, table_array, col_index_num, [range_lookup])`  
**Example:** `=VLOOKUP("Sales Executive", A:Y, 23, FALSE)`

### HLOOKUP

**Purpose:** Searches horizontally in first row, returns value from specified row  
**Syntax:** `=HLOOKUP(lookup_value, table_array, row_index_num, [range_lookup])`  
**Example:** `=HLOOKUP("Salary", 1:1, 23, FALSE)`

### INDEX

**Purpose:** Returns value at specified position in range  
**Syntax:** `=INDEX(array, row_num, [column_num])`  
**Example:** `=INDEX(Salary, 5)` - 5th salary value

### MATCH

**Purpose:** Returns relative position of item in range  
**Syntax:** `=MATCH(lookup_value, lookup_array, [match_type])`  
**Example:** `=MATCH("Research Scientist", JobRole, 0)` - Exact match position

---

## Conditional Aggregate Functions

### SUMIFS

**Purpose:** Sums values meeting multiple criteria  
**Syntax:** `=SUMIFS(sum_range, criteria_range1, criteria1, ...)`  
**Example:** `=SUMIFS(Salary, Department, "Sales", OverTime, "Yes")`

### AVERAGEIFS

**Purpose:** Averages values meeting multiple criteria  
**Syntax:** `=AVERAGEIFS(average_range, criteria_range1, criteria1, ...)`  
**Example:** `=AVERAGEIFS(HourlyRate, Gender, "Male", JobSatisfaction, "High")`

### COUNTIFS

**Purpose:** Counts cells meeting multiple criteria  
**Syntax:** `=COUNTIFS(criteria_range1, criteria1, criteria_range2, criteria2, ...)`  
**Example:** `=COUNTIFS(PerformanceRating, "Excellent", MaritalStatus, "Married")`

### MAXIFS

**Purpose:** Returns maximum value meeting criteria  
**Syntax:** `=MAXIFS(max_range, criteria_range1, criteria1, ...)`  
**Example:** `=MAXIFS(Salary, Department, "Research & Development")`

### MINIFS

**Purpose:** Returns minimum value meeting criteria  
**Syntax:** `=MINIFS(min_range, criteria_range1, criteria1, ...)`  
**Example:** `=MINIFS(YearsSinceLastPromotion, EmploymentType, "Full-time")`

### SUMPRODUCT

**Purpose:** Multiplies arrays and sums results (useful for conditional calculations)  
**Syntax:** `=SUMPRODUCT(array1, [array2], ...)`  
**Example:** `=SUMPRODUCT((Department="Sales")*Salary)` - Alternative to SUMIFS

---

## Text Functions

### CONCATENATE / &

**Purpose:** Joins text strings together  
**Syntax:** `=CONCATENATE(text1, text2, ...)` or `=text1 & text2`  
**Example:** `=Department & " " & JobRole` - "Sales Manager"

### LEN

**Purpose:** Returns number of characters in text  
**Syntax:** `=LEN(text)`  
**Example:** `=LEN(JobRole)` - Character count

### TEXT

**Purpose:** Formats values as text with specified format  
**Syntax:** `=TEXT(value, format_text)`  
**Example:** `=TEXT(DateStart, "yyyy")` - Extract year as text

---

## Date Functions

### DATE

**Purpose:** Creates date from year, month, day values  
**Syntax:** `=DATE(year, month, day)`  
**Example:** `=DATE(2025, 1, 1)` - January 1, 2025

---

## Error Handling

### IFERROR

**Purpose:** Returns specified value if formula results in error  
**Syntax:** `=IFERROR(value, value_if_error)`  
**Example:** `=IFERROR(VLOOKUP("Manager", JobRole:Salary, 23, FALSE), "Not Found")`

### ISNUMBER

**Purpose:** Checks if value is a number  
**Syntax:** `=ISNUMBER(value)`  
**Example:** `=ISNUMBER(HourlyRate)` - Returns TRUE/FALSE

---

## Advanced Functions

### FILTER (Excel 365)

**Purpose:** Filters range based on criteria  
**Syntax:** `=FILTER(array, include, [if_empty])`  
**Example:** `=FILTER(Salary, (PerformanceRating="Excellent")*(JobSatisfaction="High"))`

---

## Operators & Symbols

### Arithmetic Operators

- `+` Addition
- `-` Subtraction
- `*` Multiplication
- `/` Division
- `^` Exponentiation

### Comparison Operators

- `=` Equal to
- `<>` Not equal to
- `>` Greater than
- `<` Less than
- `>=` Greater than or equal to
- `<=` Less than or equal to

### Wildcards

- `*` Multiple characters: `=COUNTIF(JobRole, "*Scientist*")`
- `?` Single character: `=SUMIF(JobRole, "????Scientist", Salary)`
- `~` Escape wildcard: `=COUNTIF(JobRole, "*~?*")`

### Reference Operators

- `$` Absolute reference: `=$A$1` (fixed cell)
- `@` Table row reference: `=[@Salary]` (current row)
- `#` Spill reference: `=A2#` (dynamic array)
- `:#` Range trim: `=SUM(A1:A100:#)` (excludes blanks)

### Array Operators

- `{}` Array constants: `{1,2,3}` (horizontal) or `{1;2;3}` (vertical)
- Ctrl+Shift+Enter for legacy array formulas

### Text Operators

- `&` Concatenation: `=Department & "_" & JobRole`
- `'` Text prefix: `'001` (forces text format)

---

## Nested Function Patterns

### Pattern 1: IF with Logical Functions

**Use Case:** Complex conditional logic

```excel
=IF(AND(TotalWorkingYears>10, OR(OverTime="Yes", PerformanceRating="Excellent")), "Bonus", "No")
```

### Pattern 2: IFERROR with Lookup

**Use Case:** Safe lookups without errors

```excel
=IFERROR(VLOOKUP("Manager", JobRole:Salary, 23, FALSE), "Not Found")
```

### Pattern 3: INDEX/MATCH Combination

**Use Case:** Flexible lookup (better than VLOOKUP)

```excel
=INDEX(Salary, MATCH("Sales Executive", JobRole, 0))
```

### Pattern 4: Array Formula with IF

**Use Case:** Conditional averaging

```excel
{=AVERAGE(IF((Gender="Female")*(MaritalStatus="Married"), HourlyRate))}
```

_Note: Press Ctrl+Shift+Enter_

### Pattern 5: TEXT in Conditional Functions

**Use Case:** Date-based criteria

```excel
=SUMIFS(Salary, TEXT(DateStart, "yyyy"), "2013")
```

### Pattern 6: Wildcards in SUMIFS

**Use Case:** Partial text matching

```excel
=SUMIFS(Salary, JobRole, "*Scientist*", EnvironmentSatisfaction, "High")
```

### Pattern 7: Multiple Criteria with FILTER

**Use Case:** Dynamic filtered results

```excel
=FILTER(Salary, (PerformanceRating="Excellent")*(JobSatisfaction="High")*(DistanceFromHome<10))
```

### Pattern 8: SUMPRODUCT for Complex Criteria

**Use Case:** Multiple conditions without SUMIFS

```excel
=SUMPRODUCT((Department="Sales")*(JobSatisfaction="High")*Salary)
```

### Pattern 9: Nested IFS

**Use Case:** Multi-tier categorization

```excel
=IFS(PercentSalaryHike>20, "High", PercentSalaryHike>10, "Medium", TRUE, "Low")
```

### Pattern 10: XOR in Conditional Logic

**Use Case:** Exactly one condition must be true

```excel
=IF(XOR(OverTime="Yes", BusinessTravel="Travel_Frequently"), "Unique", "Not Unique")
```

---

## Quick Reference Guide

|Task|Function|Example|
|---|---|---|
|Sum with conditions|SUMIFS|`=SUMIFS(Salary, Dept, "Sales")`|
|Count with conditions|COUNTIFS|`=COUNTIFS(Gender, "F", Age, ">30")`|
|Average with conditions|AVERAGEIFS|`=AVERAGEIFS(Rate, Status, "Active")`|
|Find and return value|INDEX/MATCH|`=INDEX(Salary, MATCH(Name, EmpList, 0))`|
|Handle errors gracefully|IFERROR|`=IFERROR(formula, "Error")`|
|Multiple conditions|IFS|`=IFS(Score>90, "A", Score>80, "B")`|
|Check all conditions|AND|`=AND(A1>10, B1<5)`|
|Check any condition|OR|`=OR(Status="Active", Type="VIP")`|
|Filter data dynamically|FILTER|`=FILTER(Data, Criteria=TRUE)`|
|Concatenate text|&|`=A1 & " " & B1`|

---

## Study Tips

1. **Master the basics first:** SUM, AVERAGE, COUNT, IF
2. **Practice logical combinations:** AND, OR, NOT with IF
3. **Learn INDEX/MATCH:** More flexible than VLOOKUP
4. **Use IFERROR:** Always handle potential errors
5. **Explore conditional aggregates:** SUMIFS, COUNTIFS, AVERAGEIFS
6. **Experiment with arrays:** FILTER, SUMPRODUCT for advanced analysis
7. **Test wildcards:** Practice partial matching in text criteria
8. **Build nested formulas gradually:** Start simple, add complexity step-by-step


# More Real-Life Examples with Before/After Tables

## Sales Department Dataset

### Original Raw Data (BEFORE)

|EmployeeID|Name|Department|Sales|PerformanceRating|Bonus|Overtime|HireDate|
|---|---|---|---|---|---|---|---|
|101|Ali Khan|Sales|50000|Excellent|Yes|Yes|2015-03-15|
|102|Fatima Ahmed|Sales|45000|Good|No|No|2018-07-22|
|103|Hassan Ali|IT|55000|Excellent|Yes|Yes|2016-01-10|
|104|Ayesha Rana|Sales|48000|Good|No|Yes|2019-05-30|
|105|Ravi Singh|IT|60000|Outstanding|Yes|No|2014-11-05|
|106|Maria Santos|HR|42000|Good|No|No|2020-02-18|
|107|Omar Hassan|Sales|52000|Excellent|Yes|Yes|2017-09-12|
|108|Noor Khan|IT|58000|Excellent|Yes|Yes|2016-06-28|

---

## Example 1: SUM Function

### Task

Calculate total sales for all employees.

### Formula

$$\text{=SUM(D2:D9)}$$

### Result (AFTER)

|Calculation|Result|
|---|---|
|Total Sales|**410,000**|

**What happened:** The SUM function added all values in the Sales column: 50,000 + 45,000 + 55,000 + 48,000 + 60,000 + 42,000 + 52,000 + 58,000 = 410,000

---

## Example 2: AVERAGE Function

### Task

Find the average sales across all employees.

### Formula

$$\text{=AVERAGE(D2:D9)}$$

### Result (AFTER)

|Metric|Value|
|---|---|
|Average Sales|**51,250**|

**What happened:** AVERAGE calculated the mean by dividing total sales (410,000) by number of employees (8): 410,000 ÷ 8 = 51,250

---

## Example 3: COUNT and COUNTA Functions

### Task

Count numeric entries in Sales vs. all non-empty cells in Department.

### Formulas

$$\text{=COUNT(D2:D9)}$$ $$\text{=COUNTA(B2:B9)}$$

### Result (AFTER)

|Function|Result|
|---|---|
|COUNT (numeric Sales values)|**8**|
|COUNTA (all Department entries)|**8**|

**What happened:** COUNT only counts cells with numbers (all 8 sales values), while COUNTA counts all non-empty cells (all 8 employee names).

---

## Example 4: IF Function (Simple Logic)

### Task

Create a bonus eligibility column: If PerformanceRating is "Excellent", then "Eligible", else "Not Eligible".

### Formula

$$\text{=IF(E2="Excellent","Eligible","Not Eligible")}$$

### Result (AFTER) - New Column Added

|EmployeeID|Name|PerformanceRating|Bonus Status|
|---|---|---|---|
|101|Ali Khan|Excellent|**Eligible**|
|102|Fatima Ahmed|Good|**Not Eligible**|
|103|Hassan Ali|Excellent|**Eligible**|
|104|Ayesha Rana|Good|**Not Eligible**|
|105|Ravi Singh|Outstanding|**Not Eligible**|
|106|Maria Santos|Good|**Not Eligible**|
|107|Omar Hassan|Excellent|**Eligible**|
|108|Noor Khan|Excellent|**Eligible**|

**What happened:** The formula checked each performance rating and returned "Eligible" only for "Excellent" ratings.

---

## Example 5: AND Function (Multiple Conditions)

### Task

Identify employees who are in Sales department AND have Excellent performance.

### Formula

$$\text{=IF(AND(B2="Sales",E2="Excellent"),"Yes","No")}$$

### Result (AFTER) - New Column Added

|EmployeeID|Name|Department|PerformanceRating|Meets Criteria|
|---|---|---|---|---|
|101|Ali Khan|Sales|Excellent|**Yes**|
|102|Fatima Ahmed|Sales|Good|**No**|
|103|Hassan Ali|IT|Excellent|**No**|
|104|Ayesha Rana|Sales|Good|**No**|
|105|Ravi Singh|IT|Outstanding|**No**|
|106|Maria Santos|HR|Good|**No**|
|107|Omar Hassan|Sales|Excellent|**Yes**|
|108|Noor Khan|IT|Excellent|**No**|

**What happened:** AND required BOTH conditions to be true (Sales AND Excellent). Only rows 1 and 7 met both criteria.

---

## Example 6: OR Function (Any Condition)

### Task

Find employees who either have Outstanding rating OR work in IT department.

### Formula

$$\text{=IF(OR(E2="Outstanding",B2="IT"),"Qualifies","No")}$$

### Result (AFTER) - New Column Added

|EmployeeID|Name|Department|PerformanceRating|OR Result|
|---|---|---|---|---|
|101|Ali Khan|Sales|Excellent|**No**|
|102|Fatima Ahmed|Sales|Good|**No**|
|103|Hassan Ali|IT|Excellent|**Qualifies**|
|104|Ayesha Rana|Sales|Good|**No**|
|105|Ravi Singh|IT|Outstanding|**Qualifies**|
|106|Maria Santos|HR|Good|**No**|
|107|Omar Hassan|Sales|Excellent|**No**|
|108|Noor Khan|IT|Excellent|**Qualifies**|

**What happened:** OR returned "Qualifies" if EITHER condition was true. Rows 3, 5, and 8 met at least one criterion.

---

## Example 7: SUMIFS Function (Conditional Sum)

### Task

Calculate total sales for Sales department employees only.

### Formula

$$\text{=SUMIFS(D2:D9,B2:B9,"Sales")}$$

### Result (AFTER)

|Department|Total Sales|
|---|---|
|Sales Department Total|**195,000**|

**Details:**

- Ali Khan (Sales): 50,000
- Fatima Ahmed (Sales): 45,000
- Ayesha Rana (Sales): 48,000
- Omar Hassan (Sales): 52,000
- **Total: 195,000**

**What happened:** SUMIFS summed only rows where column B (Department) equals "Sales".

---

## Example 8: AVERAGEIFS Function (Conditional Average)

### Task

Find average sales for employees with "Excellent" performance rating.

### Formula

$$\text{=AVERAGEIFS(D2:D9,E2:E9,"Excellent")}$$

### Result (AFTER)

|Performance Rating|Average Sales|
|---|---|
|Excellent Rating Average|**51,250**|

**Details:**

- Ali Khan: 50,000
- Hassan Ali: 55,000
- Omar Hassan: 52,000
- Noor Khan: 58,000
- **Average: (50,000+55,000+52,000+58,000) ÷ 4 = 51,250**

**What happened:** AVERAGEIFS calculated the mean for only rows where column E equals "Excellent".

---

## Example 9: COUNTIFS Function (Conditional Count)

### Task

Count how many employees are in IT department with Excellent rating and work overtime.

### Formula

$$\text{=COUNTIFS(B2:B9,"IT",E2:E9,"Excellent",G2:G9,"Yes")}$$

### Result (AFTER)

|Criteria|Count|
|---|---|
|IT + Excellent + Overtime|**2**|

**Matching rows:**

- Hassan Ali (IT, Excellent, Yes)
- Noor Khan (IT, Excellent, Yes)

**What happened:** COUNTIFS counted only rows satisfying ALL three conditions simultaneously.

---

## Example 10: MAXIFS Function (Maximum with Condition)

### Task

Find the highest salary in the Sales department.

### Formula

$$\text{=MAXIFS(D2:D9,B2:B9,"Sales")}$$

### Result (AFTER)

|Department|Maximum Sales|
|---|---|
|Sales|**52,000**|

**What happened:** MAXIFS returned the largest sales value where department equals "Sales" (Omar Hassan's 52,000).

---

## Example 11: CONCATENATE and & Operator (Text Joining)

### Task

Create full employee profiles combining name and department.

### Formula Option 1

$$\text{=CONCATENATE(B2," - ",B2," Department")}$$

### Formula Option 2

$$\text{=B2 \& " (" \& B2 \& ")")}$$

### Result (AFTER) - New Column Added

|EmployeeID|Name|Department|Profile|
|---|---|---|---|
|101|Ali Khan|Sales|**Ali Khan (Sales)**|
|102|Fatima Ahmed|Sales|**Fatima Ahmed (Sales)**|
|103|Hassan Ali|IT|**Hassan Ali (IT)**|
|104|Ayesha Rana|Sales|**Ayesha Rana (Sales)**|
|105|Ravi Singh|IT|**Ravi Singh (IT)**|
|106|Maria Santos|HR|**Maria Santos (HR)**|
|107|Omar Hassan|Sales|**Omar Hassan (Sales)**|
|108|Noor Khan|IT|**Noor Khan (IT)**|

**What happened:** The & operator joined text from multiple columns together with formatting.

---

## Example 12: IFERROR Function (Error Handling)

### Task

Attempt to find a specific sales value; if not found, display "Not Available".

### Formula

$$\text{=IFERROR(VLOOKUP("Unknown",B2:D9,3,FALSE),"Not Available")}$$

### Result (AFTER)

|Lookup Attempt|Result|
|---|---|
|Search for "Unknown"|**Not Available**|

**What happened:** VLOOKUP would normally return an error because "Unknown" doesn't exist. IFERROR caught this error and displayed the custom message instead.

---

## Example 13: INDEX and MATCH (Flexible Lookup)

### Task

Find the sales value for employee named "Hassan Ali".

### Formula

$$\text{=INDEX(D2:D9,MATCH("Hassan Ali",B2:B9,0))}$$

### Result (AFTER)

|Employee|Sales|
|---|---|
|Hassan Ali|**55,000**|

**How it works:**

1. MATCH finds "Hassan Ali" in column B (position 3)
2. INDEX returns the value at position 3 in column D (55,000)

**What happened:** INDEX/MATCH combination provides more flexibility than VLOOKUP because it can search any column and return values from any column.

---

## Example 14: TEXT Function (Date Formatting)

### Task

Extract hire year and format nicely for reporting.

### Formula

$$\text{=TEXT(H2,"YYYY") & " Hire"}$$

### Result (AFTER) - New Column Added

|EmployeeID|HireDate|Hire Year Label|
|---|---|---|
|101|2015-03-15|**2015 Hire**|
|102|2018-07-22|**2018 Hire**|
|103|2016-01-10|**2016 Hire**|
|104|2019-05-30|**2019 Hire**|
|105|2014-11-05|**2014 Hire**|
|106|2020-02-18|**2020 Hire**|
|107|2017-09-12|**2017 Hire**|
|108|2016-06-28|**2016 Hire**|

**What happened:** TEXT extracted the year portion from dates and concatenated it with text for readable labels.

---

## Example 15: IFS Function (Multi-tier Logic)

### Task

Categorize employees by salary range: Premium (>55,000), Standard (45,000-55,000), Basic (<45,000).

### Formula

$$\text{=IFS(D2>55000,"Premium",D2>=45000,"Standard",TRUE,"Basic")}$$

### Result (AFTER) - New Column Added

|EmployeeID|Name|Sales|Category|
|---|---|---|---|
|101|Ali Khan|50,000|**Standard**|
|102|Fatima Ahmed|45,000|**Standard**|
|103|Hassan Ali|55,000|**Standard**|
|104|Ayesha Rana|48,000|**Standard**|
|105|Ravi Singh|60,000|**Premium**|
|106|Maria Santos|42,000|**Basic**|
|107|Omar Hassan|52,000|**Standard**|
|108|Noor Khan|58,000|**Premium**|

**What happened:** IFS tested conditions in order and assigned categories based on salary ranges.

---

## Example 16: SUMPRODUCT (Complex Calculations)

### Task

Calculate total bonus amount where: Sales > 50,000 AND Performance is "Excellent" (assume 10% bonus).

### Formula

$$\text{=SUMPRODUCT((D2:D9>50000)*(E2:E9="Excellent")_D2:D9_0.1)}$$

### Result (AFTER)

|Calculation|Result|
|---|---|
|Bonus Pool (Excellent + >50k)|**5,850**|

**Matching employees:**

- Hassan Ali: 55,000 × 0.1 = 5,500
- Omar Hassan: 52,000 × 0.1 = 5,200
- Noor Khan: 58,000 × 0.1 = 5,800
- **But only Excellent raters: Hassan (5,500) + Noor (5,800) = 11,300**

Actually: Ali Khan (50k, Excellent) doesn't qualify (not > 50k), so Hassan (5,500) + Noor (5,800) = **11,300**

**What happened:** SUMPRODUCT multiplied arrays to calculate conditional bonus amounts.

---

## Example 17: Wildcard Matching with SUMIFS

### Task

Sum sales for all employees whose department name contains "Sales" (handles variations).

### Formula

$$\text{=SUMIFS(D2:D9,B2:B9,"Sales*")}$$

### Result (AFTER)

|Search Pattern|Result|
|---|---|
|Departments containing "Sales"|**195,000**|

**What happened:** The asterisk (*) wildcard matched any text starting with "Sales", allowing flexible pattern matching.

---

## Example 18: Combined Nested Formula (Real Scenario)

### Task

Create a "Performance Bonus" column that shows:

- 15% bonus if Excellent rating AND overtime
- 10% bonus if Excellent rating only
- 5% bonus if Good rating AND overtime
- No bonus otherwise

### Formula

$$\text{=IF(AND(E2="Excellent",G2="Yes"),D2_0.15,IF(E2="Excellent",D2_0.1,IF(AND(E2="Good",G2="Yes"),D2*0.05,0)))}$$

### Result (AFTER) - New Column Added

|EmployeeID|Name|Rating|Overtime|Sales|Bonus Amount|
|---|---|---|---|---|---|
|101|Ali Khan|Excellent|Yes|50,000|**7,500** (15%)|
|102|Fatima Ahmed|Good|No|45,000|**0**|
|103|Hassan Ali|Excellent|Yes|55,000|**8,250** (15%)|
|104|Ayesha Rana|Good|Yes|48,000|**2,400** (5%)|
|105|Ravi Singh|Outstanding|No|60,000|**0**|
|106|Maria Santos|Good|No|42,000|**0**|
|107|Omar Hassan|Excellent|Yes|52,000|**7,800** (15%)|
|108|Noor Khan|Excellent|Yes|58,000|**8,700** (15%)|

**Summary After Processing:**

- Total Bonuses Awarded: 34,650
- Employees Receiving Bonus: 5

**What happened:** Nested IF statements evaluated multiple conditions and calculated different bonus percentages based on rating and overtime status.

---

## Quick Comparison: Function Use Cases

|Function|Use When|Example|
|---|---|---|
|SUM|Need total|Total all sales|
|AVERAGE|Need mean value|Average salary|
|COUNTIFS|Count with multiple criteria|Count employees: Sales + Excellent + Overtime|
|SUMIFS|Sum with multiple criteria|Sum sales for Sales dept, Excellent rating|
|AVERAGEIFS|Average with criteria|Avg salary where dept = IT|
|IF/AND/OR|Simple logic|Bonus if rating = Excellent AND overtime = Yes|
|IFS|Multiple tier categories|3+ salary bands|
|INDEX/MATCH|Flexible lookup|Find salary for any employee|
|CONCATENATE/&|Join text|Create full profile: Name (Dept)|
|IFERROR|Handle errors gracefully|Prevent #N/A errors|
|SUMPRODUCT|Complex multi-condition math|Conditional bonus calculations|

---

## Key Takeaways

1. **Functions transform data** – Raw numbers become insights through calculations
2. **Conditions filter results** – Use SUMIFS, AVERAGEIFS, COUNTIFS to work with subsets
3. **Logic statements decide** – IF, AND, OR, IFS control what happens when
4. **Text functions prepare data** – CONCATENATE and TEXT format for readability
5. **Error handling matters** – IFERROR prevents formula breakage
6. **Nested formulas solve complex problems** – Combine functions for advanced analysis
7. **Wildcards add flexibility** – * and ? allow pattern matching

---

## Common Data Analytics Scenarios

### Scenario 1: Employee Performance Analysis

```excel
=AVERAGEIFS(Salary, PerformanceRating, "Excellent", Department, "Sales")
```

### Scenario 2: Segmentation by Multiple Criteria

```excel
=COUNTIFS(Gender, "Female", TotalWorkingYears, ">10", JobSatisfaction, "High")
```

### Scenario 3: Dynamic Reporting

```excel
=FILTER(A:Z, (Department="R&D")*(Salary>80000))
```

### Scenario 4: Text Pattern Matching

```excel
=SUMIFS(Salary, JobRole, "*Manager*")
```

### Scenario 5: Year-over-Year Comparison

```excel
=SUMIFS(Revenue, TEXT(Date, "yyyy"), "2024")
```

---

_This study guide covers Excel functions essential for data analytics. Practice with real datasets to build proficiency._


References